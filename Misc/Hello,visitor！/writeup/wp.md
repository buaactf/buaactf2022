## 考点

文字和图片的base64编码、logisim电路分析、RSA解密+移位爆破、Logistic图像加密技术、信息检索、jpg隐写

## 工具

Logisim、Python、steghide

## 步骤

1.解压文件得到A letter to the visitor.txt和flag.circ两个文件，txt文件中的第一段base64解码可得信件加密的基本信息，第二段base64转图片可得一张图片。

2.利用Logisim文件打开flag.circ文件，分析电路（其实电路我设计的很简单）发现是一个移位+rsa，对于每一位message，先把二进制扩展至64位再循环左移shifter位，最后扔进rsa加密。编写脚本解密即可，rsa的N不大，直接找网站分解即可，shifter没有给出，但是可以通过移位爆破还原。

需要注意的是，由于密钥是无意义字符，在爆破解密到密钥部分的时候可能会有多个“看着比较像”的结果（七、八个左右）。

3.编写解密脚本解出txt之后得到一个密钥。flag.jpg图片是一个被加密的图片且没有给出加密代码，在图片属性中查找发现备注X0=0.66 u=3.97，搜索资料可知使用的是Logistic加密（txt中也有提示），编写解密脚本即可（网上也有现成的，但是不保证所有解密脚本和我使用的都是一个模式，可能有非预期）。解密可得前半段flag。

4.此时密钥还没有使用，根据前半段猜测使用了隐写术，而letter中的where and how I **hide** the flag 提示了使用的是steghide工具，在linux上部署工具并解密即可得到后半段flag，拼起来即可。注意上面得到的七八种可能的密钥都要遍历试一试。


## 总结

其实一开始想出一个内存审计的，但是dumpit和volatility工具调了很长时间，最后raw文件可以扫描出隐藏的文件，但是提取不出来，可能是win10虚拟机镜像有保护机制。

最后还是出了一个传统一点的，但是logisim和logistic加密这两个思路我确实没在之前的ctf中查到过，算是一点新东西吧。
