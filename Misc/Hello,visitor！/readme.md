# Hello,visitor！

| 出题人 | 题目类型 | 题目分值 |
| :--- | :--- | :--- |
| 宋靖航（ch3v4l） | MISC | 300 |

## Description

ch3v4l发现了一台尘封许久的电脑，在清理系统时发现了一封信和一个奇怪的电路，来看看里面有什么吧。

## flag

```
BUAACTF{F0ren51cs_@nd_st3g0_4r3_vvvv3Ry_G00d_fr1ends!^-^^-^}
```

## Hints

1.不止有文字可以变成base编码。

2.Visitor，你了解过图像处理吗？

3.再仔细读一读这封信，提示都在里面了。

## Attachments

| 附件名称         | 附件描述                                                     |
| :--------------- | :----------------------------------------------------------- |
| HelloVisitor.rar | 压缩包文件，里面包含A letter to the visitor.txt和flag.circ两个文件 |

### 设计思路

设计思路：主要考察的是近期CTF中常见的图像处理问题，属于传统CTF+新知识点。

本题将flag分为前后两段，前段隐藏在加密的图像中，使用的加密方式为Logistic加密。该加密是基于Logistic混沌模型提出的一个图像处理算法，在此前国内的各项CTF比赛中尚（wo）未（mei）考（cha）查（dao）。后半段利用常见隐写技术steghide隐藏在图片中。

steghide的密钥和处理后的图像隐藏在一段给visitor的信件中，信件整体为base64编码，分为两部分，前一部分解码后得到信件内容，里面给出了一个RSA+移位结构，本题没有给出RSA的脚本，而是将脚本隐藏在了一个Logisim伪电路中，也是之前CTF中从未出现过的出题方式。（但是我太菜了。。。只会RSA）

通过读懂电路可以还原出脚本，解密得到steghide密钥。后半部分base64无法解码，转图片后得到隐藏前半段flag的图片。本题解法在txt文件中都给出了提示（详见wp），但需要解题者有相关的知识储备和一定的信息检索能力。

考察知识点：文字和图片的base64编码、logisim电路分析、RSA解密+移位爆破、Logistic图像加密技术、信息检索、jpg隐写。

### 分值估计

300分，难度为中上。

### 题目部署方法

base64编码、图像加密使用Python 3.9编写脚本。

steghide工具使用kali linux系统部署。

伪电路文件使用Logisim搭建。
