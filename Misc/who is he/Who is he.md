## Who is he?

解压压缩包，打开发现里面有keyinit.jpg和Last Step.zip这两个文件，打开图片，发现图片上有一段base64编码，将其解密后得到如下字符串ZIPKEY{We1c0me_tO_

![1646837434864](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\1646837434864.png)

根据提示，这是一个压缩包秘钥的一部分。我们把图片放到010editor里面去观察，发现图片文件后面藏有一个压缩包，利用kali虚拟机，从图片中binwalk得到这个压缩包，发现压缩包已经被加密，我们需要去找到压缩包密码的后半段。在kali虚拟机中，使用strings命令，发现藏在图片中的字符串BUAACTF，所以压缩包密码为We1c0me_tO_BUAACTF

![1646837972187](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\1646837972187.png)

解压得到压缩包后，发现里面有hint.txt和secret.txt两个文件，看完hint，我们知道照片里面的人是托马斯杰斐逊，查阅相关资料，发现托马斯杰斐逊转轮，通过转轮，我们可以还原得到secret的内容，发现还原后的内容第五列为BUAABUAABUAABUAA，倒数第四列为PLAYMISCISSOOFUN，这里我们先记下这两个重要的列，会在后面使用到。

![1646838724414](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\1646838724414.png)

解压Last Step.zip，看到hint1.txt，提示我们flag需要用到二维码，flag.txt中，有45行，猜测这是一个45*45的二维码，将这45行转换成二进制，发现位数最多为45位，这也印证了我们的猜想，现在给出转换为二进制后的数据
$$
111111100110001010010101010011100000101111111
100000101001000100111011011111100101001000001
101110100101110110110010000010000101001011101
101110100111101111001100101100010001101011101
101110100011010011101111100001100111101011101
100000101001110001011000110100001000001000001
111111101010101010101010101010101010101111111
000000001110011100101000101010011011000000000
000011110010010011101111111110001111001100010
111010001011111101011111010001110101101110110
001110110101000000011000100010110001110001110
000100000101100011100110110001001100000000011
000000100000110101000011000110101101010100011
010110011001000001000001001011100101101111100
010011100100101100011000111011100111101011100
111000000011101101001011010111110100000100001
101001111101111111100001000010101100000100001
100000000110000110000001010111110101101001111
011110111000101101000100111111010111111100110
110000011100100111111001011100001011001100010
000111111110010011111111111010101111111111111
100010001110000101001000111100111000100010011
001010101100110101111010110101001000101011010
011010001000111111011000100110001101100010000
110011111010111110001111110100101100111110011
110101000101110100110011000100101100111101100
011011110000101111000011011011000000100111110
011011000111111101101000011011000100101101000
001011110110001011001101111100001010001001001
101011011001010011001101100000110101001100110
011101110000000110010111000011010001010010110
011001011000001110111000110000110010101000000
010101111000010101110101101101101110001011010
110110011110110111001101010101010101000100011
000010111110000100011000111011000100010101110
011110011010111110111011001000110100101010001
100110110011110010001111110000001100111110010
000000001100100001001000110011101001100011101
111111101100000101011010100001110000101011010
100000101001011010011000110000110110100010000
101110101011110001001111111010001101111111111
101110100101101010011110111111011100110111011
101110100101011110001010111001101110010111010
100000100100011000110111110111010100010010000
111111100100011011111101110001001100111011101
$$
利用python脚本，我们还原得到二维码图片，现给出python脚本以及二维码图片

```python
import PIL
from PIL import Image
MAX=45
img=Image.new("RGB",(MAX,MAX))
str="111111100110001010010101010011100000101111111100000101001000100111011011111100101001000001101110100101110110110010000010000101001011101101110100111101111001100101100010001101011101101110100011010011101111100001100111101011101100000101001110001011000110100001000001000001111111101010101010101010101010101010101111111000000001110011100101000101010011011000000000000011110010010011101111111110001111001100010111010001011111101011111010001110101101110110001110110101000000011000100010110001110001110000100000101100011100110110001001100000000011000000100000110101000011000110101101010100011010110011001000001000001001011100101101111100010011100100101100011000111011100111101011100111000000011101101001011010111110100000100001101001111101111111100001000010101100000100001100000000110000110000001010111110101101001111011110111000101101000100111111010111111100110110000011100100111111001011100001011001100010000111111110010011111111111010101111111111111100010001110000101001000111100111000100010011001010101100110101111010110101001000101011010011010001000111111011000100110001101100010000110011111010111110001111110100101100111110011110101000101110100110011000100101100111101100011011110000101111000011011011000000100111110011011000111111101101000011011000100101101000001011110110001011001101111100001010001001001101011011001010011001101100000110101001100110011101110000000110010111000011010001010010110011001011000001110111000110000110010101000000010101111000010101110101101101101110001011010110110011110110111001101010101010101000100011000010111110000100011000111011000100010101110011110011010111110111011001000110100101010001100110110011110010001111110000001100111110010000000001100100001001000110011101001100011101111111101100000101011010100001110000101011010100000101001011010011000110000110110100010000101110101011110001001111111010001101111111111101110100101101010011110111111011100110111011101110100101011110001010111001101110010111010100000100100011000110111110111010100010010000111111100100011011111101110001001100111011101"
i=0
for y in range (0,MAX):
    for x in range (0,MAX):
        if(str[i]=='1'):
            img.putpixel([x,y],(0,0,0))
        else:
            img.putpixel([x,y],(255,255,255))
        i=i+1
img.show()
img.save("flag.png")
```

![qrcode](C:\Users\DELL\Desktop\qrcode.png)

扫描二维码，得到字符串
$$
FjmBiHWzxXoPQGTXcqBiGeVUjF8lXh/fyI2Sfxcf97uofw1FFpdrcvoWgqiyQgHD
$$
再看hint2.txt，他要我们去搜这个歌手，并且要我们读评论，查到这个歌手，发现歌名AES，读评论，发现也只有惟一的一条，也就是用AES-CBC去进行解密，并且知道iv = BUAABUAABUAABUAA，Key = PLAYMISCISSOOFUN

![1646839361312](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\1646839361312.png)

最后解密字符串，可以得到flag:BUAACTF{There_1s_@n_AES_in_th0mAs_jEff3rSon}

![1646839499742](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\1646839499742.png)

